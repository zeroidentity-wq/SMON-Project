;------------------------------------------------------------------------------------------------------------
;pre_restart_command = if configured, will be executed before the restart command for any strategy
;restart_command = initctl restart %s
;restart_delay = if configured, will be used to set the delay before the restart command is executed
;restart_strategy = custom, service, process
;max_attempts = if configured, will be used to set the maximum number of restart attempts before giving up
;------------------------------------------------------------------------------------------------------------
;system_name = nume_real_pe_server - if configured, will be used instead of process_name for any strategy
;------------------------------------------------------------------------------------------------------------
;health_check_command = pgrep %s if configured, will be used to check the health
;health_check_timeout = 5 if configured, will be used to set the timeout for health
;------------------------------------------------------------------------------------------------------------

[database]
host = localhost
user = root
password = Parola22@@
database = v_process_monitor

[monitor]
; Check interval in seconds (2 minutes)
check_interval = 120
; Maximum number of restart failures before circuit breaker opens
max_restart_failures = 3
; Circuit breaker reset time in seconds (10 minutes)
circuit_reset_time = 600

[self_recovery]
; Path to heartbeat file written by monitor_service
heartbeat_file = /var/run/monitor_service.heartbeat
; If heartbeat older than this (in seconds), watchdog triggers recovery
stale_after_seconds = 300
; Command to restart the monitor service
restart_command = initctl restart monitor_service || service monitor_service restart || systemctl restart monitor_service
; Optional pre-check command to verify system health before restart
precheck_command = 

[logging]
; Maximum log file size in KB before rotation (default: 5MB)
max_log_size = 5120
; Number of log files to keep (default: 5)
log_files_to_keep = 5
; Log output format: text | json
format = json
; Pretty-print JSON when writing to console (files remain one-line)
json_pretty = false

[host]
; Unique numeric identifier of this host in the DB schema
host_id = 1


;Example: Using restart_command with service strategy
[process.example_service]
restart_strategy = service
restart_command = /usr/local/bin/custom_service_restart.sh
system_name = example-service
health_check_command = initctl status example-service | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

# ;Example: Custom strategy with separate restart_command and different system_name
# [process.custom_example_advanced]
# restart_strategy = custom
# restart_command = /usr/local/bin/advanced_restart.sh
# system_name = advanced-service
# health_check_command = initctl status advanced-service | grep -q start/running
# health_check_timeout = 10
# restart_delay = 3
# max_attempts = 2

# ;Example: Service strategy with different name in system vs database
# ;When the process name in database differs from the actual service name in system
# [process.mysql_database]
# restart_strategy = service
# system_name = mariadb
# health_check_command = initctl status mariadb | grep -q start/running
# health_check_timeout = 5
# restart_delay = 5
# max_attempts = 3

# ;Another example: Service strategy with different naming convention
# [process.nginx_web]
# restart_strategy = service
# system_name = nginx
# health_check_command = initctl status nginx | grep -q start/running
# health_check_timeout = 5
# restart_delay = 5
# max_attempts = 3


[process.sshd]
restart_strategy = custom
restart_command = initctl restart sshd
health_check_command = initctl status sshd | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.firewalld]
restart_strategy = custom
restart_command = initctl restart firewalld
health_check_command = initctl status firewalld | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.NetworkManager]
restart_strategy = custom
restart_command = initctl restart NetworkManager
health_check_command = initctl status NetworkManager | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.rsyslogd]
system_name = rsyslog
restart_strategy = service
health_check_command = initctl status rsyslog | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.chronyd]
restart_strategy = custom
restart_command = initctl restart chronyd
health_check_command = initctl status chronyd | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.cupsd]
restart_strategy = custom
restart_command = initctl restart cups
health_check_command = initctl status cups | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.tuned]
restart_strategy = custom
restart_command = initctl restart tuned
health_check_command = initctl status tuned | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.auditd]
restart_strategy = custom
restart_command = initctl restart auditd
health_check_command = initctl status auditd | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.crond]
restart_strategy = process
health_check_command = pgrep cron
health_check_timeout = 5
restart_delay = 2
max_attempts = 2

[process.httpd]
restart_strategy = custom
restart_command = initctl restart httpd
health_check_command = initctl status httpd | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3

[process.podman]
restart_strategy = custom
restart_command = initctl restart podman
health_check_command = initctl status podman | grep -q start/running
health_check_timeout = 5
restart_delay = 5
max_attempts = 3



